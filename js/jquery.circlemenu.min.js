/*!
 * jQuery Circle Menu
 * https://github.com/Richard1320/jQuery-Circle-Menu
 *
 * Author
 * Richard Hung
 * http://www.magicmediamuse.com/
 *
 * Version
 * 1.0.1
 *
 * Copyright (c) 2018 Richard Hung.
 *
 * License
 * jQuery Circle Menu by Richard Hung is licensed under a MIT License.
 * http://opensource.org/licenses/MIT
 */

!function(s){"use strict";var l="circleMenu",d={x:0,y:0},e={init:function(t){var o=s.extend({},{defaultRotation:0,drawLine:!1,dragMouse:!1,dragTouch:!1,dragDirection:"horizontal",lockDirection:!1,focusRotate:!1,rotateDirection:"clockwise"},t);return this.each(function(){var t=s(this),e=t.children(),i=e.children();t.addClass("circle-menu").data("settings",o).data("currentOffset",o.defaultRotation),e.addClass("circle-menu__circle").css("transform","rotate("+o.defaultRotation+"deg)"),i.addClass("circle-menu__circle__item").wrapInner('<div class="circle-menu__circle__item__inner"></div>'),t[l]("update"),(o.dragMouse||o.dragTouch)&&("horizontal"==o.dragDirection?t.addClass("is-draggable-horizontal"):t.addClass("is-draggable-vertical"),t[l]("bindDrag")),e.append('<svg class="circle-menu__circle__svg" viewbox="0 0 100 100"><circle class="circle-menu__circle__svg__circle" cx="50" cy="50" r="50" transform="rotate(-90 50 50)" /><circle class="circle-menu__circle__svg__line" cx="50" cy="50" r="50" transform="rotate(-90 50 50)" /></svg>')})},update:function(){return this.each(function(){var t=s(this),e=t.find(".circle-menu__circle__item"),i=t.data("settings"),o=360/e.length;e.each(function(){var t=s(this),e=t.index()*o;t.css("transform","rotate("+e+"deg)").data("offsetRotate",e)}),i.lockDirection&&t[l]("reLockChildren"),t[l]("directionClasses")})},reLockChildren:function(){var e=this.data("currentOffset");return this.find(".circle-menu__circle__item").each(function(){var t=s(this).data("offsetRotate");s(this).children(".circle-menu__circle__item__inner").css("transform","rotate("+-1*(t+e)+"deg)")})},directionClasses:function(){var t=this.find(".circle-menu__circle__item"),o=this.data("currentOffset");t.removeClass("position--top position--left position--right position--bottom position--bottom-right position--top-left position--top-left position--top-right position--bottom-left position--bottom-right"),t.each(function(){var t=s(this),e=t.data("offsetRotate"),i=o+e;i<0&&(i+=360),360<i&&(i-=360),337<=i&&i<=360||0<=i&&i<22?t.addClass("position--top"):22<=i&&i<67?t.addClass("position--top-right"):67<=i&&i<112?t.addClass("position--right"):112<=i&&i<157?t.addClass("position--bottom-right"):157<=i&&i<202?t.addClass("position--bottom"):202<=i&&i<247?t.addClass("position--bottom-left"):247<=i&&i<292?t.addClass("position--left"):292<=i&&i<337&&t.addClass("position--top-left")})},bindDrag:function(){var t=this.data("settings"),e="",i="",o="";return t.dragMouse&&(e+="mousedown ",i+="mousemove ",o+="mouseup "),t.dragTouch&&(e+="touchstart ",i+="touchmove ",o+="touchend touchcancel "),this.on(e,function(t){var a=s(this),c=a.data("settings"),e=t;"touchstart"==t.type&&(e=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0]),d.x=e.pageX-a.offset().left,d.y=e.pageY-a.offset().top,a.on(i,function(t){var e=t;"touchmove"==t.type&&(e=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0]);var i=e.pageX-a.offset().left,o=e.pageY-a.offset().top,n="horizontal"==c.dragDirection?i-d.x:o-d.y,r="clockwise"==c.rotateDirection?a.data("currentOffset")+n:a.data("currentOffset")-n;d.x=i,d.y=o,a[l]("rotateTo",r),t.preventDefault()}),s(window).one(o,function(){a.off(i)})}),this.find(".circle-menu__circle__item").on(e,function(t){t.stopPropagation()}),this},rotateTo:function(o){return this.each(function(){var t=s(this),e=t.data("settings"),i=t.children(".circle-menu__circle");360<o&&(o-=360),o<0&&(o+=360),t.data("currentOffset",o),i.css("transform","rotate("+o+"deg)"),e.lockDirection&&t[l]("reLockChildren"),t[l]("directionClasses")})},focus:function(c){return this.each(function(){var i=s(this),t=i.children(".circle-menu__circle"),e=i.data("settings"),o=i.find(".circle-menu__circle__item"),n=o.length,r=315-315/n*c,a=360/n*c*-1+e.defaultRotation;o.removeClass("is-active").eq(c).addClass("is-active"),e.drawLine&&i.find(".circle-menu__circle__svg__line").css("stroke-dashoffset",r),e.focusRotate&&(t.css("z-index",i.data("currentOffset")),t.animate({zIndex:a},{step:function(t,e){i[l]("rotateTo",t)},duration:1e3}))})},destroy:function(){return this.each(function(){alert("destroy")})}};s.fn[l]=function(t){return e[t]?e[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void s.error("Method "+t+" does not exist on jQuery."+l):e.init.apply(this,arguments)}}(jQuery);